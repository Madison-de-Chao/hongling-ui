<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…«å­—ç³»çµ±æ¸¬è©¦æ¡ˆä¾‹ - å‚³çµ±æŸ¥è¡¨å‹è³‡æ–™åº«é©—è­‰</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6ec4, #7873f5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            text-align: center;
            font-size: 1.2rem;
            margin-bottom: 40px;
            color: #ddd;
        }
        
        .test-group {
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .test-group h2 {
            color: #ff6ec4;
            font-size: 1.8rem;
            margin-bottom: 15px;
            border-bottom: 2px solid rgba(255, 110, 196, 0.3);
            padding-bottom: 10px;
        }
        
        .test-case {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #7873f5;
        }
        
        .test-case h3 {
            color: #7873f5;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .test-input {
            background: rgba(120, 115, 245, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 3px solid #7873f5;
        }
        
        .test-expected {
            background: rgba(255, 110, 196, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 3px solid #ff6ec4;
        }
        
        .test-verification {
            background: rgba(255, 193, 7, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 3px solid #ffc107;
        }
        
        .test-button {
            background: linear-gradient(135deg, #ff6ec4, #7873f5);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin: 10px 5px;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 110, 196, 0.4);
        }
        
        .result-area {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            min-height: 100px;
        }
        
        .highlight {
            background: rgba(255, 255, 0, 0.2);
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .critical {
            color: #ff6b6b;
            font-weight: bold;
        }
        
        .success {
            color: #51cf66;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“‹ å‚³çµ±å…«å­—æŸ¥è¡¨å‹è³‡æ–™åº«æ¸¬è©¦</h1>
        <p class="subtitle">æ¨™æº–æ¸¬è©¦ç›¤è¨­è¨ˆ - é©—è­‰ç¯€æ°£åˆ†ç•Œã€äº”è™éã€äº”é¼ éçš„ç²¾ç¢ºæ€§</p>
        
        <!-- æ¸¬è©¦çµ„1ï¼šç«‹æ˜¥å‰å¾Œé‚Šç•Œæ¸¬è©¦ -->
        <div class="test-group">
            <h2>1ï¸âƒ£ 1976å¹´ç«‹æ˜¥å‰å¾Œï¼ˆå¹´æŸ±ï¼æœˆæŸ±é‚Šç•Œæ¸¬è©¦ï¼‰</h2>
            
            <div class="test-case">
                <h3>[A1] 1976å¹´ç«‹æ˜¥å‰ä¸€åˆ†é˜</h3>
                <div class="test-input">
                    <strong>è¼¸å…¥ï¼š</strong>1976/2/5 04:59ï¼ˆAsia/Taipeiï¼ŒLSTï¼‰<br>
                    <strong>éœ€æŸ¥è¡¨ï¼š</strong>1976å¹´ç«‹æ˜¥æ™‚åˆ»ï¼ˆå¿…æŸ¥è³‡æ–™åº«Aï¼šsolar_termsï¼‰ï¼Œé ˆåˆ°åˆ†é˜
                </div>
                <div class="test-expected">
                    <strong>é æœŸçµæœï¼š</strong><br>
                    â€¢ å¹´æŸ±ï¼šå±¬å‰ä¸€å¹´ï¼ˆ1975ä¹™å¯å¹´ï¼‰<br>
                    â€¢ æœˆæŸ±ï¼šä¸‘æœˆï¼ˆç¯€æ°£åˆ†ç•Œå‰ï¼‰
                </div>
                <div class="test-verification">
                    <strong>é©—è­‰é‡é»ï¼š</strong>è‹¥å¹´åˆ†ç•Œæ²’æŒ‰ç«‹æ˜¥åˆ†é˜æŸ¥è¡¨ï¼Œé€™ç­†å¿…å®šèª¤åˆ¤
                </div>
                <button class="test-button" onclick="runTest('A1')">åŸ·è¡Œæ¸¬è©¦ A1</button>
                <div id="result-A1" class="result-area"></div>
            </div>
            
            <div class="test-case">
                <h3>[A2] 1976å¹´ç«‹æ˜¥å¾Œä¸€åˆ†é˜</h3>
                <div class="test-input">
                    <strong>è¼¸å…¥ï¼š</strong>1976/2/5 05:01ï¼ˆAsia/Taipeiï¼ŒLSTï¼‰<br>
                    <strong>éœ€æŸ¥è¡¨ï¼š</strong>åŒä¸Š
                </div>
                <div class="test-expected">
                    <strong>é æœŸçµæœï¼š</strong><br>
                    â€¢ å¹´æŸ±ï¼šä¸™è¾°å¹´<br>
                    â€¢ æœˆæŸ±ï¼šå¯…æœˆï¼ˆç«‹æ˜¥åˆ†ç•Œå¾Œï¼‰
                </div>
                <div class="test-verification">
                    <strong>é©—è­‰é‡é»ï¼š</strong>é€™çµ„æ¸¬è³‡åªæŸ¥1/1åˆ†ç•Œä¸€å®šéŒ¯ï¼Œåªæœ‰æŸ¥ç¯€æ°£åˆ†ç•Œæ‰èƒ½å°
                </div>
                <button class="test-button" onclick="runTest('A2')">åŸ·è¡Œæ¸¬è©¦ A2</button>
                <div id="result-A2" class="result-area"></div>
            </div>
        </div>
        
        <!-- æ¸¬è©¦çµ„2ï¼šç¯€æ°£é‚Šç•Œæ¸¬è©¦ -->
        <div class="test-group">
            <h2>2ï¸âƒ£ 2000å¹´ç¯€æ°£é‚Šç•Œï¼ˆæœˆæŸ±ï¼äº”è™éæ¸¬è©¦ï¼‰</h2>
            
            <div class="test-case">
                <h3>[B1] 2000å¹´ç™½éœ²å‰ä¸€åˆ†é˜</h3>
                <div class="test-input">
                    <strong>è¼¸å…¥ï¼š</strong>2000/9/7 19:59ï¼ˆAsia/Taipeiï¼‰<br>
                    <strong>éœ€æŸ¥è¡¨ï¼š</strong>2000å¹´ç™½éœ²æ™‚é–“ï¼ˆsolar_termsï¼ŒæŸ¥è¡¨åˆ†ç•Œï¼‰
                </div>
                <div class="test-expected">
                    <strong>é æœŸçµæœï¼š</strong><br>
                    â€¢ æœˆæŸ±ï¼šç”³æœˆ<br>
                    â€¢ æœˆå¹²ï¼šæŸ¥äº”è™éè¡¨å¾—æœˆå¹²
                </div>
                <div class="test-verification">
                    <strong>é©—è­‰é‡é»ï¼š</strong>åªç”¨å…¬æ›†æœˆä»½å°ç…§æœˆæ”¯æœƒåˆ¤éŒ¯ï¼Œé ˆæŸ¥åˆ†ç•Œé»
                </div>
                <button class="test-button" onclick="runTest('B1')">åŸ·è¡Œæ¸¬è©¦ B1</button>
                <div id="result-B1" class="result-area"></div>
            </div>
            
            <div class="test-case">
                <h3>[B2] 2000å¹´ç™½éœ²å¾Œä¸€åˆ†é˜</h3>
                <div class="test-input">
                    <strong>è¼¸å…¥ï¼š</strong>2000/9/7 20:01ï¼ˆAsia/Taipeiï¼‰<br>
                    <strong>éœ€æŸ¥è¡¨ï¼š</strong>åŒä¸Š
                </div>
                <div class="test-expected">
                    <strong>é æœŸçµæœï¼š</strong><br>
                    â€¢ æœˆæŸ±ï¼šé…‰æœˆ<br>
                    â€¢ æœˆå¹²ï¼šé ˆä¾æŸ¥è¡¨ã€å¹´å¹²+æœˆæ”¯ç´¢å¼•èµ°äº”è™éè¡¨
                </div>
                <div class="test-verification">
                    <strong>é©—è­‰é‡é»ï¼š</strong>ç¯€æ°£åˆ°åˆ†é˜åˆ¤æœˆåˆ†ç•Œï¼Œäº”è™éæœˆå¹²é ˆæŸ¥è¡¨
                </div>
                <button class="test-button" onclick="runTest('B2')">åŸ·è¡Œæ¸¬è©¦ B2</button>
                <div id="result-B2" class="result-area"></div>
            </div>
        </div>
        
        <!-- æ¸¬è©¦çµ„3ï¼šå¯’éœ²é‚Šç•Œæ¸¬è©¦ -->
        <div class="test-group">
            <h2>3ï¸âƒ£ 2015å¹´å¯’éœ²é‚Šç•Œï¼ˆæœˆæŸ±ï¼äº”è™éå†é©—è­‰ï¼‰</h2>
            
            <div class="test-case">
                <h3>[C1] 2015å¹´å¯’éœ²å‰ä¸€åˆ†é˜</h3>
                <div class="test-input">
                    <strong>è¼¸å…¥ï¼š</strong>2015/10/8 08:59ï¼ˆAsia/Taipeiï¼‰<br>
                    <strong>éœ€æŸ¥è¡¨ï¼š</strong>2015å¹´å¯’éœ²æ™‚åˆ»ï¼ˆsolar_termsï¼‰
                </div>
                <div class="test-expected">
                    <strong>é æœŸçµæœï¼š</strong>æœˆæŸ±æ‡‰ç‚ºé…‰æœˆï¼Œäº”è™éæœˆå¹²æŸ¥è¡¨
                </div>
                <button class="test-button" onclick="runTest('C1')">åŸ·è¡Œæ¸¬è©¦ C1</button>
                <div id="result-C1" class="result-area"></div>
            </div>
            
            <div class="test-case">
                <h3>[C2] 2015å¹´å¯’éœ²å¾Œä¸€åˆ†é˜</h3>
                <div class="test-input">
                    <strong>è¼¸å…¥ï¼š</strong>2015/10/8 09:01ï¼ˆAsia/Taipeiï¼‰<br>
                    <strong>éœ€æŸ¥è¡¨ï¼š</strong>åŒä¸Š
                </div>
                <div class="test-expected">
                    <strong>é æœŸçµæœï¼š</strong>æœˆæŸ±åˆ‡æ›åˆ°æˆŒæœˆï¼Œæœˆå¹²ä¾è¦å‰‡æŸ¥äº”è™é
                </div>
                <button class="test-button" onclick="runTest('C2')">åŸ·è¡Œæ¸¬è©¦ C2</button>
                <div id="result-C2" class="result-area"></div>
            </div>
        </div>
        
        <!-- æ¸¬è©¦çµ„4ï¼šå­æ™‚è·¨æ—¥æ¸¬è©¦ -->
        <div class="test-group">
            <h2>4ï¸âƒ£ 2020å¹´å­æ™‚è·¨æ—¥ï¼ˆæ—¥æŸ±ï¼æ™‚æŸ±é‚Šç•Œï¼‰</h2>
            
            <div class="test-case">
                <h3>[D1] 2020/4/20 23:30ï¼ˆå­æ™‚å‰åŠï¼‰</h3>
                <div class="test-input">
                    <strong>è¼¸å…¥ï¼š</strong>2020/4/20 23:30ï¼ˆAsia/Taipeiï¼ŒLSTï¼‰<br>
                    <strong>éœ€æŸ¥è¡¨ï¼š</strong>å­æ™‚å®šç¾©ï¼ˆ23:00â€“00:59ï¼‰ï¼ŒæŸ¥è¡¨è·¨æ—¥ï¼Œæ—¥æŸ±/æ™‚æŸ±è¨ˆç®—éœ€è‡ªå‹•+1å¤©
                </div>
                <div class="test-expected">
                    <strong>é æœŸçµæœï¼š</strong><br>
                    â€¢ æ—¥æŸ±ï¼šæ‡‰ä»¥2020/4/21ç‚ºåŸºæº–<br>
                    â€¢ æ™‚æŸ±ï¼šå­æ™‚ï¼ˆå†æŸ¥äº”é¼ éè¡¨å¾—æ™‚å¹²ï¼‰
                </div>
                <button class="test-button" onclick="runTest('D1')">åŸ·è¡Œæ¸¬è©¦ D1</button>
                <div id="result-D1" class="result-area"></div>
            </div>
            
            <div class="test-case">
                <h3>[D2] 2020/4/21 00:30ï¼ˆå­æ™‚å¾ŒåŠï¼‰</h3>
                <div class="test-input">
                    <strong>è¼¸å…¥ï¼š</strong>2020/4/21 00:30ï¼ˆAsia/Taipeiï¼ŒLSTï¼‰
                </div>
                <div class="test-expected">
                    <strong>é æœŸçµæœï¼š</strong>èˆ‡ä¸Šä¸€ç­†æ—¥æŸ±ç›¸åŒï¼Œæ™‚æŸ±åŒç‚ºå­æ™‚
                </div>
                <button class="test-button" onclick="runTest('D2')">åŸ·è¡Œæ¸¬è©¦ D2</button>
                <div id="result-D2" class="result-area"></div>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 40px;">
            <button class="test-button" onclick="runAllTests()" style="font-size: 1.2rem; padding: 15px 30px;">
                ğŸš€ åŸ·è¡Œå…¨éƒ¨æ¸¬è©¦
            </button>
            <button class="test-button" onclick="exportResults()" style="font-size: 1.2rem; padding: 15px 30px;">
                ğŸ“Š åŒ¯å‡ºæ¸¬è©¦å ±å‘Š
            </button>
        </div>
    </div>

    <script>
        // æ¸¬è©¦æ¡ˆä¾‹æ•¸æ“š
        const testCases = {
            'A1': {
                datetime: '1976-02-05T04:59:00',
                description: '1976å¹´ç«‹æ˜¥å‰ä¸€åˆ†é˜',
                expected: {
                    year: 'ä¹™å¯',
                    month: 'ä¸‘æœˆ',
                    critical: 'å¹´åˆ†ç•ŒæŒ‰ç«‹æ˜¥åˆ†é˜æŸ¥è¡¨'
                }
            },
            'A2': {
                datetime: '1976-02-05T05:01:00',
                description: '1976å¹´ç«‹æ˜¥å¾Œä¸€åˆ†é˜',
                expected: {
                    year: 'ä¸™è¾°',
                    month: 'å¯…æœˆ',
                    critical: 'ç¯€æ°£åˆ†ç•Œåˆ¤æ–·'
                }
            },
            'B1': {
                datetime: '2000-09-07T19:59:00',
                description: '2000å¹´ç™½éœ²å‰ä¸€åˆ†é˜',
                expected: {
                    month: 'ç”³æœˆ',
                    critical: 'ç¯€æ°£åˆ†ç•Œåˆ°åˆ†é˜'
                }
            },
            'B2': {
                datetime: '2000-09-07T20:01:00',
                description: '2000å¹´ç™½éœ²å¾Œä¸€åˆ†é˜',
                expected: {
                    month: 'é…‰æœˆ',
                    critical: 'äº”è™éæœˆå¹²æŸ¥è¡¨'
                }
            },
            'C1': {
                datetime: '2015-10-08T08:59:00',
                description: '2015å¹´å¯’éœ²å‰ä¸€åˆ†é˜',
                expected: {
                    month: 'é…‰æœˆ',
                    critical: 'å¯’éœ²åˆ†ç•Œé©—è­‰'
                }
            },
            'C2': {
                datetime: '2015-10-08T09:01:00',
                description: '2015å¹´å¯’éœ²å¾Œä¸€åˆ†é˜',
                expected: {
                    month: 'æˆŒæœˆ',
                    critical: 'æœˆæŸ±åˆ‡æ›é©—è­‰'
                }
            },
            'D1': {
                datetime: '2020-04-20T23:30:00',
                description: '2020å¹´å­æ™‚å‰åŠè·¨æ—¥',
                expected: {
                    day: 'ä»¥4/21ç‚ºåŸºæº–',
                    hour: 'å­æ™‚',
                    critical: 'å­æ™‚è·¨æ—¥é‚è¼¯'
                }
            },
            'D2': {
                datetime: '2020-04-21T00:30:00',
                description: '2020å¹´å­æ™‚å¾ŒåŠ',
                expected: {
                    day: 'èˆ‡D1ç›¸åŒæ—¥æŸ±',
                    hour: 'å­æ™‚',
                    critical: 'å­æ™‚ä¸€è‡´æ€§'
                }
            }
        };

        // åŸ·è¡Œå–®å€‹æ¸¬è©¦
        async function runTest(testId) {
            const resultDiv = document.getElementById(`result-${testId}`);
            const testCase = testCases[testId];
            
            resultDiv.innerHTML = `æ­£åœ¨æ¸¬è©¦ ${testCase.description}...\n`;
            
            try {
                const response = await fetch('https://rainbow-sanctuary-bazu-production.up.railway.app/api/bazi/compute', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        datetime_local: testCase.datetime,
                        timezone: 'Asia/Taipei',
                        longitude: 120.0,
                        use_true_solar_time: false
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const pillars = data.data.four_pillars;
                    const log = data.data.calculation_log;
                    
                    let result = `âœ… æ¸¬è©¦ ${testId} å®Œæˆ\n`;
                    result += `ğŸ“… è¼¸å…¥æ™‚é–“: ${testCase.datetime}\n`;
                    result += `ğŸ“Š è¨ˆç®—çµæœ:\n`;
                    result += `   å¹´æŸ±: ${pillars.year.stem}${pillars.year.branch}\n`;
                    result += `   æœˆæŸ±: ${pillars.month.stem}${pillars.month.branch}\n`;
                    result += `   æ—¥æŸ±: ${pillars.day.stem}${pillars.day.branch}\n`;
                    result += `   æ™‚æŸ±: ${pillars.hour.stem}${pillars.hour.branch}\n`;
                    result += `\nğŸ” è¨ˆç®—æ—¥èªŒ:\n`;
                    result += `   æœˆä»½è®ŠåŒ–: ${log.month_change || 'N/A'}\n`;
                    result += `   äº”è™é: ${log.five_tiger_index || 'N/A'}\n`;
                    result += `   äº”é¼ é: ${log.five_rat_index || 'N/A'}\n`;
                    result += `   ç¯€æ°£å‘½ä¸­: ${log.solar_term_hit || 'N/A'}\n`;
                    
                    // é©—è­‰çµæœ
                    result += `\nğŸ¯ é©—è­‰çµæœ:\n`;
                    if (testCase.expected.year) {
                        const yearMatch = `${pillars.year.stem}${pillars.year.branch}` === testCase.expected.year;
                        result += `   å¹´æŸ±: ${yearMatch ? 'âœ…' : 'âŒ'} é æœŸ ${testCase.expected.year}, å¯¦éš› ${pillars.year.stem}${pillars.year.branch}\n`;
                    }
                    if (testCase.expected.month) {
                        const monthBranch = pillars.month.branch;
                        const expectedBranch = testCase.expected.month.replace('æœˆ', '');
                        const monthMatch = monthBranch === expectedBranch;
                        result += `   æœˆæŸ±: ${monthMatch ? 'âœ…' : 'âŒ'} é æœŸ ${testCase.expected.month}, å¯¦éš› ${pillars.month.stem}${monthBranch}\n`;
                    }
                    
                    result += `\nâš ï¸  é—œéµé©—è­‰é»: ${testCase.expected.critical}`;
                    
                    resultDiv.innerHTML = result;
                } else {
                    resultDiv.innerHTML = `âŒ æ¸¬è©¦å¤±æ•—: ${data.message || 'æœªçŸ¥éŒ¯èª¤'}`;
                }
            } catch (error) {
                resultDiv.innerHTML = `âŒ ç¶²è·¯éŒ¯èª¤: ${error.message}`;
            }
        }

        // åŸ·è¡Œå…¨éƒ¨æ¸¬è©¦
        async function runAllTests() {
            for (const testId of Object.keys(testCases)) {
                await runTest(testId);
                await new Promise(resolve => setTimeout(resolve, 1000)); // å»¶é²1ç§’é¿å…APIé™åˆ¶
            }
        }

        // åŒ¯å‡ºæ¸¬è©¦å ±å‘Š
        function exportResults() {
            let report = '# å…«å­—ç³»çµ±æ¸¬è©¦å ±å‘Š\n\n';
            report += `æ¸¬è©¦æ™‚é–“: ${new Date().toLocaleString()}\n\n`;
            
            for (const testId of Object.keys(testCases)) {
                const resultDiv = document.getElementById(`result-${testId}`);
                report += `## æ¸¬è©¦ ${testId}: ${testCases[testId].description}\n`;
                report += '```\n';
                report += resultDiv.textContent || 'æœªåŸ·è¡Œ';
                report += '\n```\n\n';
            }
            
            const blob = new Blob([report], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `å…«å­—ç³»çµ±æ¸¬è©¦å ±å‘Š_${new Date().toISOString().slice(0, 10)}.md`;
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>

